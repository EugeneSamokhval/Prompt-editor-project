<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" type="text/css"?>
<svg aria-roledescription="flowchart-v2" role="graphics-document document" style="overflow: hidden; max-width: 100%; touch-action: none; user-select: none;" class="flowchart" xmlns="http://www.w3.org/2000/svg" width="100%" id="graph-2679" height="100%" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"><g id="viewport-20250524172738736" class="svg-pan-zoom_viewport" transform="matrix(0.1774519681930542,0,0,0.1774519681930542,186.5811004638672,23.860563278198242)" style="transform: matrix(0.177452, 0, 0, 0.177452, 186.581, 23.8606);"><style>#graph-2679{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:50px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#graph-2679 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#graph-2679 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#graph-2679 .error-icon{fill:hsl(220.5882352941, 100%, 98.3333333333%);}#graph-2679 .error-text{fill:rgb(8.5000000002, 5.7500000001, 0);stroke:rgb(8.5000000002, 5.7500000001, 0);}#graph-2679 .edge-thickness-normal{stroke-width:1px;}#graph-2679 .edge-thickness-thick{stroke-width:3.5px;}#graph-2679 .edge-pattern-solid{stroke-dasharray:0;}#graph-2679 .edge-thickness-invisible{stroke-width:0;fill:none;}#graph-2679 .edge-pattern-dashed{stroke-dasharray:3;}#graph-2679 .edge-pattern-dotted{stroke-dasharray:2;}#graph-2679 .marker{fill:#0b0b0b;stroke:#0b0b0b;}#graph-2679 .marker.cross{stroke:#0b0b0b;}#graph-2679 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:50px;}#graph-2679 p{margin:0;}#graph-2679 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#graph-2679 .cluster-label text{fill:rgb(8.5000000002, 5.7500000001, 0);}#graph-2679 .cluster-label span{color:rgb(8.5000000002, 5.7500000001, 0);}#graph-2679 .cluster-label span p{background-color:transparent;}#graph-2679 .label text,#graph-2679 span{fill:#333;color:#333;}#graph-2679 .node rect,#graph-2679 .node circle,#graph-2679 .node ellipse,#graph-2679 .node polygon,#graph-2679 .node path{fill:#fff4dd;stroke:hsl(40.5882352941, 60%, 83.3333333333%);stroke-width:1px;}#graph-2679 .rough-node .label text,#graph-2679 .node .label text,#graph-2679 .image-shape .label,#graph-2679 .icon-shape .label{text-anchor:middle;}#graph-2679 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#graph-2679 .rough-node .label,#graph-2679 .node .label,#graph-2679 .image-shape .label,#graph-2679 .icon-shape .label{text-align:center;}#graph-2679 .node.clickable{cursor:pointer;}#graph-2679 .root .anchor path{fill:#0b0b0b!important;stroke-width:0;stroke:#0b0b0b;}#graph-2679 .arrowheadPath{fill:#0b0b0b;}#graph-2679 .edgePath .path{stroke:#0b0b0b;stroke-width:2.0px;}#graph-2679 .flowchart-link{stroke:#0b0b0b;fill:none;}#graph-2679 .edgeLabel{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#graph-2679 .edgeLabel p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);}#graph-2679 .edgeLabel rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#graph-2679 .labelBkg{background-color:rgba(243.9999999999, 220.9999999998, 255, 0.5);}#graph-2679 .cluster rect{fill:hsl(220.5882352941, 100%, 98.3333333333%);stroke:hsl(220.5882352941, 60%, 88.3333333333%);stroke-width:1px;}#graph-2679 .cluster text{fill:rgb(8.5000000002, 5.7500000001, 0);}#graph-2679 .cluster span{color:rgb(8.5000000002, 5.7500000001, 0);}#graph-2679 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(220.5882352941, 100%, 98.3333333333%);border:1px solid hsl(220.5882352941, 60%, 88.3333333333%);border-radius:2px;pointer-events:none;z-index:100;}#graph-2679 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#graph-2679 rect.text{fill:none;stroke-width:0;}#graph-2679 .icon-shape,#graph-2679 .image-shape{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);text-align:center;}#graph-2679 .icon-shape p,#graph-2679 .image-shape p{background-color:hsl(-79.4117647059, 100%, 93.3333333333%);padding:2px;}#graph-2679 .icon-shape rect,#graph-2679 .image-shape rect{opacity:0.5;background-color:hsl(-79.4117647059, 100%, 93.3333333333%);fill:hsl(-79.4117647059, 100%, 93.3333333333%);}#graph-2679 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#graph-2679 .io&gt;*{fill:#E0F7FA!important;stroke:#047B9B!important;stroke-width:1px!important;}#graph-2679 .io span{fill:#E0F7FA!important;stroke:#047B9B!important;stroke-width:1px!important;}#graph-2679 .proc&gt;*{fill:#FFF3E0!important;stroke:#E65100!important;stroke-width:1px!important;}#graph-2679 .proc span{fill:#FFF3E0!important;stroke:#E65100!important;stroke-width:1px!important;}#graph-2679 .decis&gt;*{fill:#F1F8E9!important;stroke:#558B2F!important;stroke-width:1px!important;}#graph-2679 .decis span{fill:#F1F8E9!important;stroke:#558B2F!important;stroke-width:1px!important;}#graph-2679 .startend&gt;*{fill:#ECEFF1!important;stroke:#607D8B!important;stroke-width:1px!important;}#graph-2679 .startend span{fill:#ECEFF1!important;stroke:#607D8B!important;stroke-width:1px!important;}</style><g><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="5" viewBox="0 0 10 10" class="marker flowchart-v2" id="graph-2679_flowchart-v2-pointEnd"><path style="stroke-width: 1px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="8" markerWidth="8" markerUnits="userSpaceOnUse" refY="5" refX="4.5" viewBox="0 0 10 10" class="marker flowchart-v2" id="graph-2679_flowchart-v2-pointStart"><path style="stroke-width: 1px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart-v2" id="graph-2679_flowchart-v2-circleEnd"><circle style="stroke-width: 1px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart-v2" id="graph-2679_flowchart-v2-circleStart"><circle style="stroke-width: 1px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="graph-2679_flowchart-v2-crossEnd"><path style="stroke-width: 2px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart-v2" id="graph-2679_flowchart-v2-crossStart"><path style="stroke-width: 2px; stroke-dasharray: 1px, 0px;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"><g data-look="classic" id="subGraph0" class="cluster"><rect height="2463.1166381835938" width="1070.2083129882812" y="743" x="8" style=""></rect><g transform="translate(402.2208251953125, 743)" class="cluster-label"><foreignObject height="225" width="281.76666259765625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Цикл по категориям k</p></span></div></foreignObject></g></g></g><g class="edgePaths"><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_A_B_0" d="M1558.342,98L1558.342,102.167C1558.342,106.333,1558.342,114.667,1558.412,122.417C1558.482,130.167,1558.623,137.334,1558.693,140.917L1558.763,144.501"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_B_C_0" d="M1558.842,388.5L1558.758,392.583C1558.675,396.667,1558.508,404.833,1558.425,412.417C1558.342,420,1558.342,427,1558.342,430.5L1558.342,434"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_C_D_0" d="M1558.342,693L1558.342,697.167C1558.342,701.333,1558.342,709.667,1558.342,718C1558.342,726.333,1558.342,734.667,1558.342,742.333C1558.342,750,1558.342,757,1558.342,760.5L1558.342,764"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_D_E_0" d="M1558.342,1023L1558.342,1027.167C1558.342,1031.333,1558.342,1039.667,1558.342,1096.314C1558.342,1152.961,1558.342,1257.922,1558.342,1310.403L1558.342,1362.883"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_E_F_0" d="M1558.342,1546.883L1558.342,1606.281C1558.342,1665.678,1558.342,1784.472,1558.342,1866.119C1558.342,1947.767,1558.342,1992.267,1558.342,2014.517L1558.342,2036.767"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_H_I_0" d="M522.829,985.5L522.829,995.917C522.829,1006.333,522.829,1027.167,522.899,1041.167C522.97,1055.167,523.11,1062.334,523.18,1065.917L523.251,1069.501"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_J_0" d="M402.262,1720.199L388.085,1750.71C373.908,1781.222,345.554,1842.244,331.377,1895.005C317.2,1947.767,317.2,1992.267,317.2,2014.517L317.2,2036.767"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_J_G_0" d="M317.2,2295.767L317.2,2312.433C317.2,2329.1,317.2,2362.433,342.21,2410.773C367.221,2459.113,417.242,2522.46,442.252,2554.133L467.263,2585.806"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_I_K_0" d="M650.804,1713.792L666.461,1745.371C682.119,1776.95,713.435,1840.109,729.092,1881.438C744.75,1922.767,744.75,1942.267,744.75,1952.017L744.75,1961.767"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_K_G_0" d="M744.75,2370.767L744.75,2374.933C744.75,2379.1,744.75,2387.433,740.348,2408.523C735.946,2429.613,727.142,2463.459,722.739,2480.382L718.337,2497.305"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_F_G_0" d="M1346.958,2238.005L1267.26,2264.298C1187.561,2290.592,1028.164,2343.179,933.298,2396.204C838.431,2449.229,808.096,2502.691,792.928,2529.422L777.761,2556.154"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_G_L_0" d="M637.421,3181.617L637.337,3185.7C637.254,3189.783,637.087,3197.95,637.004,3218.7C636.921,3239.45,636.921,3272.783,636.921,3305.45C636.921,3338.117,636.921,3370.117,636.921,3386.117L636.921,3402.117"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_L_M_0" d="M636.921,3661.117L636.921,3665.283C636.921,3669.45,636.921,3677.783,636.921,3685.45C636.921,3693.117,636.921,3700.117,636.921,3703.617L636.921,3707.117"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_M_N_0" d="M636.921,3891.117L636.921,3895.283C636.921,3899.45,636.921,3907.783,636.921,3915.45C636.921,3923.117,636.921,3930.117,636.921,3933.617L636.921,3937.117"></path><path marker-end="url(#graph-2679_flowchart-v2-pointEnd)" style="" class="edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link" id="L_N_O_0" d="M636.921,4121.117L636.921,4125.283C636.921,4129.45,636.921,4137.783,636.921,4145.45C636.921,4153.117,636.921,4160.117,636.921,4163.617L636.921,4167.117"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(317.1999969482422, 1903.2666625976562)" class="edgeLabel"><g transform="translate(-30.10832977294922, -37.5)" class="label"><foreignObject height="75" width="60.21665954589844"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Да</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(744.7499847412109, 1903.2666625976562)" class="edgeLabel"><g transform="translate(-41.34166717529297, -37.5)" class="label"><foreignObject height="75" width="82.68333435058594"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"><p>Нет</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 3306.1166381835938)" class="edgeLabel"><g transform="translate(-136.39999389648438, -75)" class="label"><foreignObject height="150" width="272.79998779296875"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="edgeLabel"><p>все обработаны</p></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div class="labelBkg" xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(1558.3416442871094, 53)" id="flowchart-A-0" class="node default startend"><rect height="90" width="146.88333129882812" y="-45" x="-73.44166564941406" ry="45" rx="45" style="fill:#ECEFF1 !important;stroke:#607D8B !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-54.69166564941406, -37.5)" style="" class="label"><rect></rect><foreignObject height="75" width="109.38333129882812"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>Start</p></span></div></foreignObject></g></g><g transform="translate(1558.3416442871094, 268)" id="flowchart-B-1" class="node default io"><polygon style="fill:#E0F7FA !important;stroke:#047B9B !important;stroke-width:1px !important" transform="translate(-107.5,120)" class="label-container" points="-120,0 215,0 335,-240 0,-240"></polygon><g transform="translate(-100, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="200"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Вход: prompt, ai_type</p></span></div></foreignObject></g></g><g transform="translate(1558.3416442871094, 565.5)" id="flowchart-C-2" class="node default proc"><rect height="255" width="542.8666687011719" y="-127.5" x="-271.43333435058594" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-241.43333435058594, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="482.8666687011719"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Получить weighted_max_words<br/>по ai_type</p></span></div></foreignObject></g></g><g transform="translate(1558.3416442871094, 895.5)" id="flowchart-D-3" class="node default proc"><rect height="255" width="495.29998779296875" y="-127.5" x="-247.64999389648438" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-217.64999389648438, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="435.29998779296875"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Количество токенов = len(word_tokenize)</p></span></div></foreignObject></g></g><g transform="translate(1558.3416442871094, 1456.8833312988281)" id="flowchart-E-4" class="node default proc"><rect height="180" width="890.2666625976562" y="-90" x="-445.1333312988281" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-415.1333312988281, -75)" style="" class="label"><rect></rect><foreignObject height="150" width="830.2666625976562"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Разбить prompt<br/>prompt_tokenizer.tokenize_prompt()</p></span></div></foreignObject></g></g><g transform="translate(1558.3416442871094, 2168.2666625976562)" id="flowchart-F-5" class="node default proc"><rect height="255" width="422.76666259765625" y="-127.5" x="-211.38333129882812" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-181.38333129882812, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="362.76666259765625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>rating = 0;<br/>all_max_tokens = Σ(weights)</p></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 2800.941650390625)" id="flowchart-G-12" class="node default decis"><polygon style="fill:#F1F8E9 !important;stroke:#558B2F !important;stroke-width:1px !important" transform="translate(-380.1750030517578,380.1750030517578)" class="label-container" points="380.1750030517578,0 760.3500061035156,-380.1750030517578 380.1750030517578,-760.3500061035156 0,-380.1750030517578"></polygon><g transform="translate(-140.1750030517578, -225)" style="" class="label"><rect></rect><foreignObject height="450" width="280.3500061035156"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Следующая категория k?<br/>(clarity, descriptive …)</p></span></div></foreignObject></g></g><g transform="translate(522.8291625976562, 895.5)" id="flowchart-H-13" class="node default proc"><rect height="180" width="637.066650390625" y="-90" x="-318.5333251953125" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-288.5333251953125, -75)" style="" class="label"><rect></rect><foreignObject height="150" width="577.066650390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>entries = len(tokenized_prompt[k])</p></span></div></foreignObject></g></g><g transform="translate(522.8291625976562, 1456.8833312988281)" id="flowchart-I-14" class="node default decis"><polygon style="fill:#F1F8E9 !important;stroke:#558B2F !important;stroke-width:1px !important" transform="translate(-383.8833312988281,383.8833312988281)" class="label-container" points="383.8833312988281,0 767.7666625976562,-383.8833312988281 383.8833312988281,-767.7666625976562 0,-383.8833312988281"></polygon><g transform="translate(-181.38333129882812, -187.5)" style="" class="label"><rect></rect><foreignObject height="375" width="362.76666259765625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>entries/num_tokens<br/>≤ weight_k/all_max_tokens ?</p></span></div></foreignObject></g></g><g transform="translate(317.1999969482422, 2168.2666625976562)" id="flowchart-J-15" class="node default proc"><rect height="255" width="329.0333251953125" y="-127.5" x="-164.51666259765625" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-134.51666259765625, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="269.0333251953125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>rating += entries/num_tokens</p></span></div></foreignObject></g></g><g transform="translate(744.7499847412109, 2168.2666625976562)" id="flowchart-K-16" class="node default proc"><rect height="405" width="426.066650390625" y="-202.5" x="-213.0333251953125" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-183.0333251953125, -187.5)" style="" class="label"><rect></rect><foreignObject height="375" width="366.066650390625"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>rating += (2·weight_k/all_max_tokens)<br/> - entries/num_tokens</p></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 3533.6166381835938)" id="flowchart-L-28" class="node default proc"><rect height="255" width="407.70001220703125" y="-127.5" x="-203.85000610351562" style="fill:#FFF3E0 !important;stroke:#E65100 !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-173.85000610351562, -112.5)" style="" class="label"><rect></rect><foreignObject height="225" width="347.70001220703125"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>rating *= 2·num_tokens/all_max_tokens</p></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 3801.1166381835938)" id="flowchart-M-30" class="node default io"><rect height="180" width="266.9499969482422" y="-90" x="-133.4749984741211" style="fill:#E0F7FA !important;stroke:#047B9B !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-103.4749984741211, -75)" style="" class="label"><rect></rect><foreignObject height="150" width="206.9499969482422"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>Вывести rating</p></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 4031.1166381835938)" id="flowchart-N-32" class="node default io"><rect height="180" width="459.3833312988281" y="-90" x="-229.69166564941406" style="fill:#E0F7FA !important;stroke:#047B9B !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-199.69166564941406, -75)" style="" class="label"><rect></rect><foreignObject height="150" width="399.3833312988281"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;"><span class="nodeLabel"><p>/Возврат: ceil(rating·1000)/</p></span></div></foreignObject></g></g><g transform="translate(636.9208221435547, 4216.116638183594)" id="flowchart-O-34" class="node default startend"><rect height="90" width="119.44999694824219" y="-45" x="-59.724998474121094" ry="45" rx="45" style="fill:#ECEFF1 !important;stroke:#607D8B !important;stroke-width:1px !important" class="basic label-container"></rect><g transform="translate(-40.974998474121094, -37.5)" style="" class="label"><rect></rect><foreignObject height="75" width="81.94999694824219"><div xmlns="http://www.w3.org/1999/xhtml" style="display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;"><span class="nodeLabel"><p>End</p></span></div></foreignObject></g></g></g></g></g></g></svg>